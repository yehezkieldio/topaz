[changelog]
header = """
# Changelog\n
All notable changes to this project will be documented in this file.\n
**NOTE:** Changes are ordered by date, starting with the most oldest to the most recent.\n
> This project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html) and uses [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) for commit messages.\n
"""
body = """
{%- macro remote_url() -%}
  https://github.com/{{ remote.github.owner }}/{{ remote.github.repo }}
{%- endmacro -%}

{% if version -%}
  ## {{ version | trim_start_matches(pat="v") }} ({{ timestamp | date(format="%B %d, %Y") | replace(from=" 0", to=" ") }})
{% else -%}
  ## Unreleased
{% endif -%}

{% if message -%}
  ### ğŸ“ Release Notes
  {{ message | safe }}
{% endif -%}

{% for group, commits in commits | group_by(attribute="group") %}
### {{ group | replace(from="<!-- \\d+ -->", to="") | trim | upper_first }}
{% for commit in commits -%}
{%- set commit_title = commit.message | split(pat="\n") | first | trim -%}
{%- set normalized_title = commit_title -%}
{%- set pr_markup = "" -%}
{%- if commit.remote.pr_number -%}
  {%- set pr_url = "https://github.com/" ~ remote.github.owner ~ "/" ~ remote.github.repo ~ "/issues/" ~ commit.remote.pr_number -%}
  {%- set pr_markup = "([#" ~ commit.remote.pr_number ~ "](" ~ pr_url ~ "))" -%}
  {%- set normalized_title = normalized_title | replace(from=" " ~ pr_markup, to="") | replace(from=pr_markup, to="") | trim -%}
{%- endif -%}
{%- set author_segment = "" -%}
{%- if commit.remote.pr_number and commit.remote.username -%}
  {%- if commit.remote.username != "renovate[bot]" and commit.remote.username != "github-actions[bot]" and commit.remote.username != "yehezkieldio" and commit.remote.username != "Copilot" -%}
    {%- set author_segment = " by [@" ~ commit.remote.username ~ "](https://github.com/" ~ commit.remote.username ~ ")" -%}
  {%- else -%}
    {%- set author_segment = " by " ~ commit.remote.username -%}
  {%- endif -%}
{%- endif -%}
{%- set commit_url = "https://github.com/" ~ remote.github.owner ~ "/" ~ remote.github.repo ~ "/commit/" ~ commit.id -%}
- [`{{ commit.id | truncate(length=7, end="") }}`]({{ commit_url }}){% if commit.scope %} {{ commit.scope }}:{% endif %} {{ normalized_title | upper_first }}{% if author_segment != "" %}{{ author_segment }}{% endif %}{% if pr_markup != "" %} {{ pr_markup }}{% endif %}
{%- if commit.body %}
{% for line in commit.body | split(pat="\n") %}
  {{ line }}
{% endfor %}
{%- endif %}
{%- if commit.breaking %}
{% if commit.footers | length > 0 %}
  {% for breakingChange in commit.footers %}
  - ğŸ’¥ **{{ breakingChange.token }}{{ breakingChange.separator }}** {{ breakingChange.value }}
  {% endfor %}
{% else %}
  - ğŸ’¥ **BREAKING CHANGE:** This commit introduces a breaking change.
{% endif %}
{%- endif %}
{% endfor -%}

{% endfor %}
"""
footer = ""
trim = true
postprocessors = []

[git]
conventional_commits = true
filter_unconventional = false
commit_preprocessors = [
  { pattern = "\\(#([0-9]+)\\)", replace = "([#${1}](https://github.com/yehezkieldio/topaz/issues/${1}))" },
]
commit_parsers = [
  { message = "^chore\\(release\\): release", skip = true },
  { message = "^chore: release", skip = true },
  { message = "^chore\\(version\\)", skip = true },
  { message = "^fix\\(deps\\)", group = "<!-- 2 -->ğŸ§© Dependencies Updates" },
  { message = "^chore\\(deps\\)", group = "<!-- 2 -->ğŸ§© Dependencies Updates" },
  { message = "^build\\(deps\\)", group = "<!-- 2 -->ğŸ§© Dependencies Updates" },
  { message = "^style\\(deps\\)", group = "<!-- 2 -->ğŸ§© Dependencies Updates" },
  { message = "^perf\\(deps\\)", group = "<!-- 2 -->ğŸ§© Dependencies Updates" },
  { message = "^deps:", group = "<!-- 2 -->ğŸ§© Dependencies Updates" },
  { message = "^feat!|^feat\\(.*\\)!", group = "<!-- 3 -->ğŸš€ New Features", breaking = true },
  { message = "^fix!|^fix\\(.*\\)!", group = "<!-- 4 -->ğŸ› Bug Fixes", breaking = true },
  { message = "^refactor!|^refactor\\(.*\\)!", group = "<!-- 7 -->ğŸšœ Refactor", breaking = true },
  { message = "^perf!|^perf\\(.*\\)!", group = "<!-- 6 -->âš¡ Performance", breaking = true },
  { message = "^feat", group = "<!-- 3 -->ğŸš€ New Features" },
  { message = "^feature", group = "<!-- 3 -->ğŸš€ New Features" },
  { message = "^fix", group = "<!-- 4 -->ğŸ› Bug Fixes" },
  { message = "^docs", group = "<!-- 5 -->ğŸ“š Documentation" },
  { message = "^refactor", group = "<!-- 7 -->ğŸšœ Refactor" },
  { message = "^build\\(deps\\)", group = "<!-- 2 -->ğŸ§© Dependencies Updates" },
  { message = "^build", group = "<!-- 8 -->ğŸ—ï¸ Build System" },
  { message = "^style\\(deps\\)", group = "<!-- 2 -->ğŸ§© Dependencies Updates" },
  { message = "^style", group = "<!-- 9 -->ğŸ¨ Code Styling" },
  { message = "^format", group = "<!-- 9 -->ğŸ¨ Code Styling" },
  { message = "^test", group = "<!-- 10 -->ğŸ§ª Test" },
  { message = "^tests", group = "<!-- 10 -->ğŸ§ª Test" },
  { message = "^chore\\(ci\\)", group = "<!-- 16 -->ğŸ¤– CI/CD" },
  { message = "^ci", group = "<!-- 16 -->ğŸ¤– CI/CD" },
  { message = "^chore", group = "<!-- 11 -->ğŸ› ï¸ Miscellaneous" },
  { message = "^security", group = "<!-- 12 -->ğŸ”’ Security" },
  { message = "^compat", group = "<!-- 13 -->ğŸ”— Compatibility" },
  { message = "^revert", group = "<!-- 14 -->âª Reverts" },
  { message = "^Revert", group = "<!-- 14 -->âª Reverts" },
  { message = "^i18n", group = "<!-- 15 -->ğŸŒ Internationalization" },
  { message = "^locale", group = "<!-- 15 -->ğŸŒ Internationalization" },
  { message = "^translation", group = "<!-- 15 -->ğŸŒ Internationalization" },
  { message = "^ci", group = "<!-- 16 -->ğŸ¤– CI/CD" },
  { message = ".*deprecated", body = ".*deprecated", group = "<!-- 30 -->âš ï¸ Deprecation" },
  { message = ".*", group = "<!-- 99 -->ğŸŒ€ Other" },
]
filter_commits = false
tag_pattern = "topaz@[0-9]"
ignore_tags = ""
topo_order = false
sort_commits = "oldest"

[remote.github]
owner = "yehezkieldio"
repo = "topaz"
