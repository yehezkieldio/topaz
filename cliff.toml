[changelog]
header = """
# Changelog\n
All notable changes to this project will be documented in this file.\n
**NOTE:** Changes are ordered by date, starting with the most oldest to the most recent.\n
> This project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html) and uses [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) for commit messages.\n
"""
body = """
{%- macro remote_url() -%}
  https://github.com/{{ remote.github.owner }}/{{ remote.github.repo }}
{%- endmacro -%}

{% if version -%}
  ## {{ version | trim_start_matches(pat="v") }} ({{ timestamp | date(format="%B %d, %Y") | replace(from=" 0", to=" ") }})
{% else -%}
  ## Unreleased
{% endif -%}

{% if message -%}
  ### 📝 Release Notes
  {{ message | safe }}
{% endif -%}

{% for group, commits in commits | group_by(attribute="group") %}
    ### {{ group | replace(from="<!-- \\d+ -->", to="") | trim | upper_first }}
    {%- for commit in commits %}
      {% set commit_title = commit.message | split(pat="\n") | first %}
      - [`{{ commit.id | truncate(length=7, end="") }}`]({{ self::remote_url() }}/commit/{{ commit.id }}){% if commit.scope %} {{ commit.scope }}:{% endif %} {{ commit_title | trim | upper_first }}
      {%- if commit.remote.pr_number %}
        {%- if commit.remote.username != "renovate[bot]" and commit.remote.username != "github-actions[bot]" -%}
          by [@{{ commit.remote.username }}](https://github.com/{{ commit.remote.username }})
        {%- else -%}
          by {{ commit.remote.username }}
        {%- endif -%}
      {%- endif %}
      {%- if commit.body %}
        {% for line in commit.body | split(pat="\n") %}
          {{ line }}
        {% endfor %}
      {%- endif %}
      {%- if commit.breaking %}
        {% if commit.footers | length > 0 %}
          {% for breakingChange in commit.footers %}
          - 💥 **{{ breakingChange.token }}{{ breakingChange.separator }}** {{ breakingChange.value }}
          {% endfor %}
        {% else %}
          - 💥 **BREAKING CHANGE:** This commit introduces a breaking change.
        {% endif %}
      {%- endif %}
    {% endfor %}
{% endfor %}
"""
footer = ""
trim = true
postprocessors = []

[git]
conventional_commits = true
filter_unconventional = false
commit_preprocessors = [
  { pattern = "\\(#([0-9]+)\\)", replace = "([#${1}](https://github.com/yehezkieldio/topaz/issues/${1}))" },
]
commit_parsers = [
  { message = "^chore\\(release\\): release", skip = true },
  { message = "^fix\\(deps\\)", group = "<!-- 2 -->🧩 Dependencies Updates" },
  { message = "^chore\\(deps\\)", group = "<!-- 2 -->🧩 Dependencies Updates" },
  { message = "^feat!|^feat\\(.*\\)!", group = "<!-- 3 -->🚀 New Features", breaking = true },
  { message = "^feat", group = "<!-- 3 -->🚀 New Features" },
  { message = "^fix!|^fix\\(.*\\)!", group = "<!-- 4 -->🐛 Bug Fixes", breaking = true },
  { message = "^fix", group = "<!-- 4 -->🐛 Bug Fixes" },
  { message = "^docs", group = "<!-- 5 -->📚 Documentation" },
  { message = "^perf", group = "<!-- 6 -->⚡ Performance" },
  { message = "^refactor", group = "<!-- 7 -->🚜 Refactor" },
  { message = "^style\\(deps\\)", group = "<!-- 2 -->🧩 Dependencies Updates" },
  { message = "^style\\(.*\\)", group = "<!-- 9 -->🎨 Code Styling" },
  { message = "^style", group = "<!-- 9 -->🎨 Code Styling" },
  { message = "^test", group = "<!-- 10 -->🧪 Test" },
  { message = "^chore", group = "<!-- 11 -->🛠️ Miscellaneous" },
  { message = "^security", group = "<!-- 12 -->🔒 Security" },
  { message = "^compat", group = "<!-- 13 -->🔗 Compatibility" },
  { message = "^revert", group = "<!-- 14 -->⏪ Reverts" },
  { message = "^i18n", group = "<!-- 15 -->🌐 Internationalization" },
  { message = "^chore\\(ci\\)", group = "<!-- 16 -->🤖 CI/CD" },
  { message = "^ci", group = "<!-- 16 -->🤖 CI/CD" },
  { message = ".*", group = "<!-- 17 -->🛠️ Miscellaneous" },
  { message = ".*deprecated", body = ".*deprecated", group = "⚠️ Deprecation" },
]
filter_commits = false
tag_pattern = "topaz@[0-9]"
ignore_tags = ""
topo_order = false
sort_commits = "oldest"

[remote.github]
owner = "yehezkieldio"
repo = "topaz"
